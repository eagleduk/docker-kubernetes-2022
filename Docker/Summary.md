# Summary

---

### Container & Image

- 실행하고자 하는 코드와 실행 환경을 이미지로 생성한다. (이미지 = 템플릿)
- 생성된 이미지를 기반으로 여러개의 컨테이너를 생성한다.
- 컨테이너와 컨테이너는 독립적인 애플리케이션이 된다.
- 컨테이너는 복사된 이미지에서 새로운 환경을 구축할 수 없고 이미지의 환경만을 사용할 수 있다.

| 컨테이너                                                                    | 이미지                                                                                                                                     |
| --------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------ |
| 코드와 코드를 실행하는데 필요한 환경을 포함하는 격리된 박스                 | Dockerfile 또는 DockerHub에서 생성                                                                                                         |
| 하나의 태스크에 집중(FE, BE, DB) ⇒ 공유 및 재생산이 쉬운 작고 가벼운 패키지 | Dockerfile에 코드의 환경 포함                                                                                                              |
| 볼륨을 제외한 컨테이너의 데이터는 컨테이너가 종료될 때마다 손실             | 공유가능 및 이미지를 기반으로 다중컨테이너 생성가능                                                                                        |
| 이미지의 부가 레이어                                                        | 컨테이너에 대한 블루 프린트                                                                                                                |
| 하나의 이미지에서 다중 컨테이너 실행 가능                                   | 일기 전용이므로 이미지 자체 실행 불가                                                                                                      |
|                                                                             | 이미지는 변경되지 않으며 쉽게 빌드되어 다른 사람들과 공유 가능                                                                             |
|                                                                             | 이미지 생성시 레이어가 캐쉬되어 있으며 변경된 부분에 대하여 해당 부분부터 레이어가 다시 캐쉬되어 생성되는 프로세서이므로 효율적이고 빠르다 |

---

### COMMANDS

- 이미지는 [REPOSITORY](:[TAG]) 를 사용하여 이름:버전 형식으로 여러 이미지를 그룹으로 관리할 수 있다.
- Dockerfile 및 Repository를 사용하여 작업중인 image를 공유할 수 있다.

---

### DATA

- docker 에는 볼륨, 바인드 마운트를 사용하여 데이터를 임시 또는 영구적 으로 저장, 읽기, 삭제 및 공유할 수 있다.
- 바운드 바운드
  - 호스트 머신에 특정 경로 존재. 경로와 컨테이너에 미러링.
  - 실행중인 컨테이너에 적용해야 하는 일부 소스코드 또는 구성이 있는 경우 일반적으로 사용
- 볼륨
  - 컨테이너의 폴더가 호스트 머신에 미러링 되지만, 호스트 머신의 위치는 알수 없다.
  - 컨테이너가 실행될때 유지되며 컨테이너가 종료될때 유지(명명) 또는 삭제(익명)을 선택할 수 있다.

| 익명 볼륨                                                                             | 명명 볼륨                                                            | 바인드 마운트                                                        |
| ------------------------------------------------------------------------------------- | -------------------------------------------------------------------- | -------------------------------------------------------------------- |
| 컨테이너가 제거될 때 익명 볼륨도 제거 됨으로 컨테이너간 데이터를 공유할 수 없다.      | 특정 컨테이너에 연결되어 있지 않다.                                  | 특정 컨테이너에 연결되어 있지 않다.                                  |
| 컨테이너에 존재하는 특정 데이터를 잠그는데 유용                                       | 컨테이너가 삭제되어도 존재함으로 컨테이너간 데이터를 공유할 수 있다. | 컨테이너가 삭제되어도 존재함으로 컨테이너간 데이터를 공유할 수 있다. |
| 컨테이너가 존재하는 동안 저장됨으로 모든 데이터를 컨테이너 내부에 저장할 필요가 없다. | 호스트에서 위치를 파악할 수 없다.                                    | 호스트 머신에서 컨테이너로 라이브 데이터를 제공하는데 사용된다.      |
| 외부 경로보다 내부 경로의 우선순위를 높이는 역할을 한다.                              |                                                                      | 호스트 머신의 변경사항(생성, 수정, 삭제)가 컨테이너에도 적용된다.    |
| 호스트에서 위치를 파악할 수 없다.                                                     |                                                                      |                                                                      |

---

### NETWORKS

- 컨테이너에서는 웹 서버등에 대한 요청이 항상 가능하다.
- 로컬 호스트 머신에 대한 요청은 `host.docker.internal` 도메인으로 쉽게 수행할 수 있다.
- 컨테이너간 요청은 1) IP 조회 2) docker network 구축 을 사용하여 수행할 수 있다.
  1. IP조회: 컨테이너의 IP를 확인 → 컨테이너가 실행될 때마다 IP가 변경됨
  2. Docker 네트워크: 서로 통신하려는 컨테이너 모두를 동일한 네트워크에 추가. 컨테이너의 이름을 주소로 사용가능

---

### Compose

- docker cmd 명령만으로는 옵션이 많을 수록 관리하기 어렵기 때문에 옵션을 미리 설정해놓은 파일(_.yaml, _.yml)을 이용하여 다중 컨테이너를 하나의 명령으로 제어

---

### Multi Stage

- 이미지 내의 빌드 단계를 포하시키고 시작될 떄 완료된 결과물이 있는 컨테이너를 가질수 있다.
- React 같이 배포시 소스코드 bulid 단계가 있는 개발 환경에 사용

---

- 격리, 캡슐화 및 재현 가능한 개발환경을 가지고 있기 때문에 상호 종속성이 없고 로컬 시스템의 개발이 편리하고 관리가 쉬워 시스템의 다른 환경과 충돌하지 않는다.
- 다중 프로젝트에서 작업하기 쉽고 작업 버전에 따른 런타임간 충돌을 피할 수 있다.
